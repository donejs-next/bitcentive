<html>
  <head>
    <title>{{title}}</title>
  </head>
  <body>
    <can-import from="bootstrap/dist/css/bootstrap.css" />
    <can-import from="bitcentive/styles.less" />
    <can-import from="bitcentive/app" export-as="viewModel" />
    <can-import from="can-stache/helpers/route"/>

    {{#is sessionPromiseStatus "pending"}}
      <div class="loader">
        Loading...
      </div>
    {{/is}}

    {{#is sessionPromiseStatus "resolved"}}
      <div class="header">
        {{#if session.isUserLoggedIn}}
          <span class="email">{{session.user.email}}</span>
          <a class="logout" href="#" ($click)="doLogout">Logout</a>
        {{/if}}
      </div>

      <div class="content">
        {{#if session.isUserLoggedIn}}
          {{#switch page}}
            {{#default}}
            <can-import from="bitcentive/components/select-contribution-month/"/>
            <can-import from="bitcentive/components/contribution-month/"/>
            <bit-select-contribution-month {(selected-contribution-month-id)}="pageId"/>
          {{#if pageId}}
            <bit-contribution-month {contribution-month-id}="pageId"/>
          {{/if}}
            {{/default}}
          {{/switch}}
        {{else}}
          <can-import from="bitcentive/components/auth/"/>
          <bit-auth {(session)}="session" {(page)}="page" />
        {{/if}}
      </div>

      <div class="footer"></div>
    {{/is}}

    {{#switch env.NODE_ENV}}
      {{#case "production"}}
        <script src="{{joinBase 'node_modules/steal/steal.production.js'}}"  main="bitcentive/index.stache!done-autorender"></script>
      {{/case}}
      {{#default}}
        <script src="/node_modules/steal/steal.js"></script>
      {{/default}}
    {{/switch}}
  </body>
</html>
